# Frontend Build And Tooling

## Package Scripts

Defined as tasks in `deno.json` at the project root. Deno runs all commands — no `pnpm` or `npm`.

| Command | Purpose |
| --- | --- |
| `deno task dev` | Start Vite dev server with HMR |
| `deno task build` | Production build via SvelteKit |
| `deno task preview` | Preview the production build locally |
| `deno task check` | Run `svelte-check` for type and template errors |
| `deno task lint` | Run ESLint |
| `deno task lint:fix` | Run ESLint with auto-fix |
| `deno task format` | Format code with Prettier |
| `deno task format:check` | Check formatting without writing |
| `deno task db:generate` | Generate Drizzle ORM migrations |
| `deno task db:migrate` | Run Drizzle migrations |
| `deno task db:push` | Push schema directly to database |
| `deno task db:studio` | Open Drizzle Studio |

## Deno

Deno is the project runtime. It provides native TypeScript support, secure-by-default permissions, and npm package compatibility.

**Configuration:** `deno.json` at the project root defines:
- **Tasks** — all dev, build, lint, format, and database commands.
- **Import maps** — dependency resolution (replaces `package.json` dependencies).
- **Compiler options** — `strict: true`, `checkJs: false`.

```jsonc
// deno.json (excerpt)
{
  "tasks": {
    "dev": "deno run -A npm:vite dev",
    "build": "deno run -A npm:vite build",
    "preview": "deno run -A npm:vite preview",
    "check": "deno run -A npm:svelte-check --tsconfig ./tsconfig.json"
  }
}
```

## Vite

Config in `vite.config.ts` at the project root.

Two plugins are registered:
- `@tailwindcss/vite` — Tailwind CSS 4 integration (replaces PostCSS pipeline).
- `@sveltejs/vite-plugin-svelte` — Svelte compilation (registered implicitly via `sveltekit()`).

```typescript
// vite.config.ts
import { sveltekit } from "@sveltejs/kit/vite";
import tailwindcss from "@tailwindcss/vite";
import { defineConfig } from "vite";

export default defineConfig({
  plugins: [tailwindcss(), sveltekit()],
});
```

No React plugin, no Sentry plugin, no PostCSS config. Tailwind CSS 4 runs entirely through its Vite plugin.

## SvelteKit

Config in `svelte.config.js` at the project root.

```javascript
// svelte.config.js
import adapter from "@sveltejs/adapter-auto";
import { vitePreprocess } from "@sveltejs/vite-plugin-svelte";

export default {
  preprocess: vitePreprocess(),
  kit: {
    adapter: adapter(),
    alias: {
      "$lib": "./src/lib",
      "$lib/*": "./src/lib/*",
    },
  },
};
```

**Adapter:** `@sveltejs/adapter-auto` for development, with `@deno/svelte-adapter` available for production Deno deployment.

**Preprocessor:** `vitePreprocess()` handles TypeScript and CSS preprocessing within `.svelte` files.

## TypeScript

- App config: `tsconfig.json` at the project root.
- Extends `.svelte-kit/tsconfig.json` (auto-generated by SvelteKit).
- Strict mode enabled.

```jsonc
// tsconfig.json
{
  "extends": "./.svelte-kit/tsconfig.json",
  "compilerOptions": {
    "strict": true,
    "moduleResolution": "bundler"
  }
}
```

**Type checking:** Run `deno task check` which invokes `svelte-check`. This validates both TypeScript and Svelte template types in a single pass — no separate `tsc` step needed.

**Ambient types:** SvelteKit auto-generates types in `.svelte-kit/types/`. Route-specific types (`PageServerLoad`, `Actions`, `$types`) are generated per route directory.

## ESLint

Config in `eslint.config.js` at the project root (flat config format).

```javascript
// eslint.config.js
import js from "@eslint/js";
import ts from "typescript-eslint";
import svelte from "eslint-plugin-svelte";
import svelteParser from "svelte-eslint-parser";
import globals from "globals";

export default ts.config(
  js.configs.recommended,
  ...ts.configs.recommended,
  ...svelte.configs["flat/recommended"],
  {
    files: ["**/*.svelte", "**/*.svelte.ts"],
    languageOptions: {
      parser: svelteParser,
      parserOptions: {
        parser: ts.parser,
      },
    },
  },
  {
    languageOptions: {
      globals: { ...globals.browser, ...globals.node },
    },
  },
  {
    ignores: [
      ".svelte-kit/",
      "build/",
      "node_modules/",
    ],
  },
);
```

Key plugins:
- `typescript-eslint` — TypeScript rules.
- `eslint-plugin-svelte` — Svelte-specific linting (template expressions, reactivity, accessibility).

## Prettier

Config in `.prettierrc` at the project root.

```json
{
  "semi": true,
  "singleQuote": false,
  "tabWidth": 2,
  "trailingComma": "all",
  "printWidth": 80,
  "plugins": ["prettier-plugin-svelte"],
  "overrides": [
    {
      "files": "*.svelte",
      "options": {
        "parser": "svelte"
      }
    }
  ]
}
```

The `prettier-plugin-svelte` plugin enables formatting of `.svelte` files, handling script, template, and style blocks.

A `.prettierignore` excludes generated directories:

```
.svelte-kit
build
node_modules
```

## Tailwind CSS 4

No `tailwind.config.js`. Tailwind CSS 4 is configured entirely through CSS and the Vite plugin.

- Vite plugin: `@tailwindcss/vite` in `vite.config.ts`.
- CSS entry: `src/app.css` with `@import "tailwindcss"`.
- Design tokens: CSS custom properties in `src/app.css`, registered via `@theme inline`.
- No PostCSS config file needed.

See `specs/frontend-styling.md` for the full design token system.

## shadcn-svelte

Config in `components.json` at the project root:

```json
{
  "$schema": "https://shadcn-svelte.com/schema.json",
  "style": "default",
  "tailwind": {
    "config": "",
    "css": "src/app.css",
    "baseColor": "slate"
  },
  "aliases": {
    "components": "$lib/components/ui",
    "utils": "$lib/utils"
  }
}
```

Components are added via the shadcn-svelte CLI and land in `src/lib/components/ui/`.

## File Locations

| File | Purpose |
| --- | --- |
| `deno.json` | Runtime config, tasks, import maps |
| `svelte.config.js` | SvelteKit adapter, preprocessor, aliases |
| `vite.config.ts` | Vite plugins (Tailwind, SvelteKit) |
| `tsconfig.json` | TypeScript compiler options |
| `eslint.config.js` | ESLint flat config with Svelte plugin |
| `.prettierrc` | Prettier config with Svelte plugin |
| `.prettierignore` | Prettier ignore patterns |
| `components.json` | shadcn-svelte component generation |
| `src/app.css` | Tailwind imports, design tokens, base styles |
| `src/app.html` | HTML shell with SvelteKit placeholders |
